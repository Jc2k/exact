# Main Makefile for exact
# (c) 2003 Doug WInter

SHELL = /bin/sh
top_srcdir = @top_srcdir@
srcdir = @srcdir@
VPATH = @srcdir@

.SUFFIXES:
.SUFFIXES: .c .o

OPT = -g -O
AR = ar
AR_FLAGS = rc
RANLIB = @RANLIB@

CC= @CC@
CFLAGS = -Wall -I. @CFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@
INSTALL = @INSTALL@
prefix = @prefix@
exec_prefix = @exec_prefix@
localstatedir = @localstatedir@
bindir = $(exec_prefix)/bin
libdir = $(prefix)/lib
infodir = $(prefix)/info

SOURCES = tail.c daemon.c exact.c debugmsg.c match.c auth.c conffile.c
DOCS = exact.man
MISC = configure mkinstalldirs install-sh aclocal.m4
OBJS = tail.o daemon.o exact.o debugmsg.o match.o auth.o conffile.o

all: exact exact.conf

install: all
	$(top_srcdir)/mkinstalldirs $(bindir)
	$(INSTALL) exact $(bindir)/exact

uninstall:
	/bin/rm -f $(bindir)/exact

exact: $(OBJS)
	$(CC) $(CFLAGS) -o exact $(OBJS) $(LIBS)

clean:
	/bin/rm -f core *.o $(OBJS) $(LIB_OBJS) exact exact.conf

distclean: clean
	/bin/rm -f Makefile config.h config.status config.cache config.log
	/bin/rm -f configure autoscan.log configure.scan
	/bin/rm -rf autom4te.cache config.h.in~

mostlyclean: clean

maintainer-clean: clean

edit = sed \
        -e 's,@datadir\@,$(pkgdatadir),g' \
        -e 's,@prefix\@,$(prefix),g' \
		-e 's,@localstatedir\@,$(localstatedir),g'

exact.conf: exact.conf.in Makefile
	rm -f exact.conf exact.conf.tmp
	$(edit) exact.conf.in > exact.conf.tmp
	 mv exact.conf.tmp exact.conf
	
